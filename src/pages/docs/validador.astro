---
import DocsLayout from "../../layouts/Layout.astro";
import { ShieldCheck } from "lucide-static";
import CodeBlock from "../../components/CodeBlock.astro";

const ejemplo = `import { validateXml } from "osodreamer-sri-xml-signer";
import * as fs from "fs";

const xml = fs.readFileSync("./comprobante_firmado.xml");


const validatedXmlResponse = await validateXml({ xml, env: "test" }); // "test" o "prod"

console.log(validatedXmlResponse);`;
---

<DocsLayout title="Validador XML ">
  <section class="mb-12 text-center max-w-2xl mx-auto">
    <h1 class="text-3xl font-bold text-white mb-3">Validador XML</h1>
    <p class="text-zinc-400 text-base">
      Envía el comprobante firmado al <strong
        >web service de recepción del SRI</strong
      > y obtiene una respuesta oficial que indica si fue aceptado o rechazado.
    </p>
  </section>

  <section class="mb-24">
    <div
      class="bg-zinc-900 border border-zinc-800 p-6 sm:p-8 rounded-2xl max-w-3xl mx-auto shadow-md"
    >
      <div class="flex items-start gap-3 mb-4">
        <span class="text-indigo-400 w-5 h-5 mt-1"><ShieldCheck /></span>
        <h2 class="text-lg font-semibold text-white">Uso básico</h2>
      </div>

      <CodeBlock code={ejemplo} filename="validar.ts" language="ts" />

      <hr class="my-8 border-zinc-700" />

      <div
        class="text-sm text-zinc-400 text-left bg-zinc-800/40 p-6 rounded-xl"
      >
        <h3 class="text-base font-semibold text-white mb-4">¿Qué valida?</h3>

        <ul
          class="list-disc list-inside text-sm text-zinc-400 pl-4 space-y-1 mb-4"
        >
          <li>
            Envia el XML firmado al <strong
              >servicio de recepción del SRI</strong
            > (SOAP)
          </li>
          <li>Valida estructura, firma digital y consistencia general</li>
          <li>
            Retorna respuesta JSON con estado (`RECIBIDA`, `DEVUELTA`, etc.)
          </li>
          <li>
            Funciona para ambientes de <code>pruebas</code> o <code
              >producción</code
            >
          </li>
        </ul>

        <p class="text-sm text-zinc-400">
          Este paso es obligatorio antes de autorizar el comprobante. Si el SRI
          responde <code>DEVUELTA</code>, no se puede continuar.
        </p>

        <div
          class="flex flex-col sm:flex-row sm:items-center sm:justify-start gap-4 mt-6"
        >
          <a
            href="/docs/modelo-datos/validador"
            class="inline-flex items-center h-10 px-4 border border-indigo-500 text-indigo-400 rounded-md hover:bg-indigo-950 transition text-sm font-medium"
          >
            Ver estructura del modelo
          </a>
          <a
            href="/docs/autorizador"
            class="px-6 h-10 inline-flex items-center justify-center rounded-md bg-indigo-500 hover:bg-indigo-400 text-white text-sm font-medium transition"
          >
            Ir al autorizador
          </a>
        </div>
      </div>
    </div>
  </section>
</DocsLayout>
